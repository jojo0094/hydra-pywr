{
  "timestepper": {
    "start": "2018-01-01",
    "end": "2018-12-31",
    "timestep": 1
  },
  "metadata": {
    "description": "Exercise 3d from Pywr basic training.",
    "title": "Exercise 3d - Demand restrictions with time varying inflow."
  },
  "edges": [
    ["input1", "river1"],
    ["river1", "river2"],
    ["river2", "mrf"],
    ["river2", "river3"],
    ["mrf", "output1"],
    ["river3", "output1"],
    ["river1", "abs1"],
    ["abs1", "reservoir1"],
    ["input2", "reservoir1"],
    ["reservoir1", "release1"],
    ["release1", "river2"],
    ["reservoir1", "demand1"]
  ],
  "nodes": [
    {
      "name": "input1",
      "type": "catchment",
      "flow": {
        "type": "dataframe",
        "data": {"0":{"2018-01-01":11.9991110353,"2018-01-02":11.9964444044,"2018-01-03":11.9920008977,"2018-01-04":11.9857818318,"2018-01-05":11.9777890496,"2018-01-06":11.9680249195,"2018-01-07":11.9564923347,"2018-01-08":11.9431947128,"2018-01-09":11.928135994,"2018-01-10":11.9113206405,"2018-01-11":11.8927536352,"2018-01-12":11.8724404798,"2018-01-13":11.8503871935,"2018-01-14":11.8266003113,"2018-01-15":11.8010868816,"2018-01-16":11.7738544647,"2018-01-17":11.7449111301,"2018-01-18":11.7142654544,"2018-01-19":11.6819265185,"2018-01-20":11.6479039051,"2018-01-21":11.6122076959,"2018-01-22":11.5748484684,"2018-01-23":11.535837293,"2018-01-24":11.4951857296,"2018-01-25":11.452905824,"2018-01-26":11.4090101048,"2018-01-27":11.3635115791,"2018-01-28":11.3164237292,"2018-01-29":11.2677605082,"2018-01-30":11.2175363361,"2018-01-31":11.1657660953,"2018-02-01":11.1124651266,"2018-02-02":11.0576492241,"2018-02-03":11.001334631,"2018-02-04":10.9435380345,"2018-02-05":10.884276561,"2018-02-06":10.823567771,"2018-02-07":10.7614296537,"2018-02-08":10.6978806221,"2018-02-09":10.632939507,"2018-02-10":10.566625552,"2018-02-11":10.4989584072,"2018-02-12":10.429958124,"2018-02-13":10.3596451486,"2018-02-14":10.2880403163,"2018-02-15":10.215164845,"2018-02-16":10.1410403295,"2018-02-17":10.0656887343,"2018-02-18":9.9891323878,"2018-02-19":9.9113939753,"2018-02-20":9.8324965323,"2018-02-21":9.7524634379,"2018-02-22":9.6713184076,"2018-02-23":9.5890854864,"2018-02-24":9.5057890418,"2018-02-25":9.4214537562,"2018-02-26":9.3361046199,"2018-02-27":9.2497669239,"2018-02-28":9.1624662519,"2018-03-01":9.0742284728,"2018-03-02":8.9850797334,"2018-03-03":8.8950464506,"2018-03-04":8.8041553029,"2018-03-05":8.7124332236,"2018-03-06":8.6199073917,"2018-03-07":8.5266052248,"2018-03-08":8.4325543702,"2018-03-09":8.3377826972,"2018-03-10":8.2423182887,"2018-03-11":8.146189433,"2018-03-12":8.049424615,"2018-03-13":7.9520525083,"2018-03-14":7.8541019662,"2018-03-15":7.7556020138,"2018-03-16":7.6565818386,"2018-03-17":7.5570707824,"2018-03-18":7.4570983326,"2018-03-19":7.356694113,"2018-03-20":7.2558878758,"2018-03-21":7.1547094918,"2018-03-22":7.0531889425,"2018-03-23":6.9513563106,"2018-03-24":6.8492417713,"2018-03-25":6.7468755833,"2018-03-26":6.64428808,"2018-03-27":6.5415096602,"2018-03-28":6.4385707794,"2018-03-29":6.3355019406,"2018-03-30":6.2323336854,"2018-03-31":6.1290965846,"2018-04-01":6.0258212298,"2018-04-02":5.9225382235,"2018-04-03":5.8192781709,"2018-04-04":5.7160716701,"2018-04-05":5.6129493033,"2018-04-06":5.509941628,"2018-04-07":5.4070791676,"2018-04-08":5.3043924024,"2018-04-09":5.2019117608,"2018-04-10":5.0996676099,"2018-04-11":4.997690247,"2018-04-12":4.8960098901,"2018-04-13":4.7946566692,"2018-04-14":4.6936606176,"2018-04-15":4.5930516626,"2018-04-16":4.4928596167,"2018-04-17":4.393114169,"2018-04-18":4.2938448763,"2018-04-19":4.1950811542,"2018-04-20":4.0968522685,"2018-04-21":3.9991873265,"2018-04-22":3.9021152685,"2018-04-23":3.805664859,"2018-04-24":3.7098646784,"2018-04-25":3.6147431143,"2018-04-26":3.5203283533,"2018-04-27":3.4266483725,"2018-04-28":3.3337309314,"2018-04-29":3.2416035633,"2018-04-30":3.1502935676,"2018-05-01":3.0598280014,"2018-05-02":2.9702336717,"2018-05-03":2.8815371271,"2018-05-04":2.7937646503,"2018-05-05":2.7069422503,"2018-05-06":2.6210956544,"2018-05-07":2.5362503007,"2018-05-08":2.4524313308,"2018-05-09":2.3696635821,"2018-05-10":2.2879715804,"2018-05-11":2.2073795329,"2018-05-12":2.1279113206,"2018-05-13":2.0495904918,"2018-05-14":1.9724402546,"2018-05-15":1.8964834703,"2018-05-16":1.8217426464,"2018-05-17":1.7482399304,"2018-05-18":1.6759971027,"2018-05-19":1.6050355703,"2018-05-20":1.5353763608,"2018-05-21":1.4670401156,"2018-05-22":1.4000470842,"2018-05-23":1.3344171182,"2018-05-24":1.270169665,"2018-05-25":1.2073237627,"2018-05-26":1.1458980338,"2018-05-27":1.08591068,"2018-05-28":1.027379477,"2018-05-29":0.9703217687,"2018-05-30":0.9147544626,"2018-05-31":0.8606940246,"2018-06-01":0.8081564738,"2018-06-02":0.7571573783,"2018-06-03":0.7077118503,"2018-06-04":0.6598345414,"2018-06-05":0.6135396388,"2018-06-06":0.5688408607,"2018-06-07":0.5257514522,"2018-06-08":0.4842841817,"2018-06-09":0.4444513368,"2018-06-10":0.406264721,"2018-06-11":0.3697356496,"2018-06-12":0.334874947,"2018-06-13":0.3016929433,"2018-06-14":0.2701994709,"2018-06-15":0.240403862,"2018-06-16":0.2123149459,"2018-06-17":0.1859410457,"2018-06-18":0.1612899766,"2018-06-19":0.1383690433,"2018-06-20":0.1171850378,"2018-06-21":0.0977442374,"2018-06-22":0.0800524027,"2018-06-23":0.0641147762,"2018-06-24":0.0499360806,"2018-06-25":0.0375205174,"2018-06-26":0.0268717655,"2018-06-27":0.0179929804,"2018-06-28":0.0108867932,"2018-06-29":0.0055553094,"2018-06-30":0.0020001089,"2018-07-01":0.0002222453,"2018-07-02":0.0002222453,"2018-07-03":0.0020001089,"2018-07-04":0.0055553094,"2018-07-05":0.0108867932,"2018-07-06":0.0179929804,"2018-07-07":0.0268717655,"2018-07-08":0.0375205174,"2018-07-09":0.0499360806,"2018-07-10":0.0641147762,"2018-07-11":0.0800524027,"2018-07-12":0.0977442374,"2018-07-13":0.1171850378,"2018-07-14":0.1383690433,"2018-07-15":0.1612899766,"2018-07-16":0.1859410457,"2018-07-17":0.2123149459,"2018-07-18":0.240403862,"2018-07-19":0.2701994709,"2018-07-20":0.3016929433,"2018-07-21":0.334874947,"2018-07-22":0.3697356496,"2018-07-23":0.406264721,"2018-07-24":0.4444513368,"2018-07-25":0.4842841817,"2018-07-26":0.5257514522,"2018-07-27":0.5688408607,"2018-07-28":0.6135396388,"2018-07-29":0.6598345414,"2018-07-30":0.7077118503,"2018-07-31":0.7571573783,"2018-08-01":0.8081564738,"2018-08-02":0.8606940246,"2018-08-03":0.9147544626,"2018-08-04":0.9703217687,"2018-08-05":1.027379477,"2018-08-06":1.08591068,"2018-08-07":1.1458980338,"2018-08-08":1.2073237627,"2018-08-09":1.270169665,"2018-08-10":1.3344171182,"2018-08-11":1.4000470842,"2018-08-12":1.4670401156,"2018-08-13":1.5353763608,"2018-08-14":1.6050355703,"2018-08-15":1.6759971027,"2018-08-16":1.7482399304,"2018-08-17":1.8217426464,"2018-08-18":1.8964834703,"2018-08-19":1.9724402546,"2018-08-20":2.0495904918,"2018-08-21":2.1279113206,"2018-08-22":2.2073795329,"2018-08-23":2.2879715804,"2018-08-24":2.3696635821,"2018-08-25":2.4524313308,"2018-08-26":2.5362503007,"2018-08-27":2.6210956544,"2018-08-28":2.7069422503,"2018-08-29":2.7937646503,"2018-08-30":2.8815371271,"2018-08-31":2.9702336717,"2018-09-01":3.0598280014,"2018-09-02":3.1502935676,"2018-09-03":3.2416035633,"2018-09-04":3.3337309314,"2018-09-05":3.4266483725,"2018-09-06":3.5203283533,"2018-09-07":3.6147431143,"2018-09-08":3.7098646784,"2018-09-09":3.805664859,"2018-09-10":3.9021152685,"2018-09-11":3.9991873265,"2018-09-12":4.0968522685,"2018-09-13":4.1950811542,"2018-09-14":4.2938448763,"2018-09-15":4.393114169,"2018-09-16":4.4928596167,"2018-09-17":4.5930516626,"2018-09-18":4.6936606176,"2018-09-19":4.7946566692,"2018-09-20":4.8960098901,"2018-09-21":4.997690247,"2018-09-22":5.0996676099,"2018-09-23":5.2019117608,"2018-09-24":5.3043924024,"2018-09-25":5.4070791676,"2018-09-26":5.509941628,"2018-09-27":5.6129493033,"2018-09-28":5.7160716701,"2018-09-29":5.8192781709,"2018-09-30":5.9225382235,"2018-10-01":6.0258212298,"2018-10-02":6.1290965846,"2018-10-03":6.2323336854,"2018-10-04":6.3355019406,"2018-10-05":6.4385707794,"2018-10-06":6.5415096602,"2018-10-07":6.64428808,"2018-10-08":6.7468755833,"2018-10-09":6.8492417713,"2018-10-10":6.9513563106,"2018-10-11":7.0531889425,"2018-10-12":7.1547094918,"2018-10-13":7.2558878758,"2018-10-14":7.356694113,"2018-10-15":7.4570983326,"2018-10-16":7.5570707824,"2018-10-17":7.6565818386,"2018-10-18":7.7556020138,"2018-10-19":7.8541019662,"2018-10-20":7.9520525083,"2018-10-21":8.049424615,"2018-10-22":8.146189433,"2018-10-23":8.2423182887,"2018-10-24":8.3377826972,"2018-10-25":8.4325543702,"2018-10-26":8.5266052248,"2018-10-27":8.6199073917,"2018-10-28":8.7124332236,"2018-10-29":8.8041553029,"2018-10-30":8.8950464506,"2018-10-31":8.9850797334,"2018-11-01":9.0742284728,"2018-11-02":9.1624662519,"2018-11-03":9.2497669239,"2018-11-04":9.3361046199,"2018-11-05":9.4214537562,"2018-11-06":9.5057890418,"2018-11-07":9.5890854864,"2018-11-08":9.6713184076,"2018-11-09":9.7524634379,"2018-11-10":9.8324965323,"2018-11-11":9.9113939753,"2018-11-12":9.9891323878,"2018-11-13":10.0656887343,"2018-11-14":10.1410403295,"2018-11-15":10.215164845,"2018-11-16":10.2880403163,"2018-11-17":10.3596451486,"2018-11-18":10.429958124,"2018-11-19":10.4989584072,"2018-11-20":10.566625552,"2018-11-21":10.632939507,"2018-11-22":10.6978806221,"2018-11-23":10.7614296537,"2018-11-24":10.823567771,"2018-11-25":10.884276561,"2018-11-26":10.9435380345,"2018-11-27":11.001334631,"2018-11-28":11.0576492241,"2018-11-29":11.1124651266,"2018-11-30":11.1657660953,"2018-12-01":11.2175363361,"2018-12-02":11.2677605082,"2018-12-03":11.3164237292,"2018-12-04":11.3635115791,"2018-12-05":11.4090101048,"2018-12-06":11.452905824,"2018-12-07":11.4951857296,"2018-12-08":11.535837293,"2018-12-09":11.5748484684,"2018-12-10":11.6122076959,"2018-12-11":11.6479039051,"2018-12-12":11.6819265185,"2018-12-13":11.7142654544,"2018-12-14":11.7449111301,"2018-12-15":11.7738544647,"2018-12-16":11.8010868816,"2018-12-17":11.8266003113,"2018-12-18":11.8503871935,"2018-12-19":11.8724404798,"2018-12-20":11.8927536352,"2018-12-21":11.9113206405,"2018-12-22":11.928135994,"2018-12-23":11.9431947128,"2018-12-24":11.9564923347,"2018-12-25":11.9680249195,"2018-12-26":11.9777890496,"2018-12-27":11.9857818318,"2018-12-28":11.9920008977,"2018-12-29":11.9964444044,"2018-12-30":11.9991110353,"2018-12-31":12.0}},
        "pandas_kwargs": {
          "parse_dates": true
        }
      },
      "position": {
        "geographic": [0, 0]
      }
    },
    {
      "name": "river1",
      "type": "link",
      "position": {
        "geographic": [0, 25]
      }
    },
    {
      "name": "river2",
      "type": "link",
      "position": {
        "geographic": [0, 75]
      }
    },
    {
      "name": "mrf",
      "type": "link",
      "max_flow": 2,
      "cost": -10,
      "position": {
        "geographic": [-10, 100]
      }
    },
    {
      "name": "river3",
      "type": "link",
      "position": {
        "geographic": [10, 100]
      }
    },
    {
      "name": "abs1",
      "type": "link",
      "max_flow": 5,
      "cost": 0.1,
      "position": {
        "geographic": [25, 25]
      }
    },
    {
      "name": "release1",
      "type": "link",
      "position": {
        "geographic": [25, 75]
      }
    },
    {
      "name": "input2",
      "type": "catchment",
      "flow": 3,
      "position": {
        "geographic": [50, 25]
      }
    },
    {
      "name": "reservoir1",
      "type": "storage",
      "max_volume": 365,
      "initial_volume": 365,
      "cost": -1,
      "position": {
        "geographic": [50, 50]
      }
    },
    {
      "name": "output1",
      "type": "output",
      "position": {
        "geographic": [0, 125]
      }
    },
    {
      "name": "demand1",
      "type": "output",
      "cost": -10,
      "max_flow": {
        "type": "aggregatedparameter",
        "agg_func": "product",
        "parameters": [
          "__demand1__:base_demand",
          "__reservoir1__:demand_saving_factor"
        ]
      },
      "position": {
        "geographic": [50, 100]
      }
    }
  ],
  "parameters": {
    "__demand1__:base_demand": {
      "type": "monthlyprofile",
      "values": [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
    },
    "__reservoir1__:demand_saving_factor": {
      "type": "indexedarrayparameter",
      "index_parameter": "__reservoir1__:demand_saving_level",
      "params": [1.0, 0.85, 0.6]
    },
    "__reservoir1__:demand_saving_level": {
      "type": "controlcurveindexparameter",
      "storage_node": "reservoir1",
      "control_curves": [
        {
          "type": "monthlyprofile",
          "values": [
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8
          ]
        },
        {
          "type": "monthlyprofile",
          "values": [
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5
          ]
        }
      ]
    }
  }
}

